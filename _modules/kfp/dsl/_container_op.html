

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>kfp.dsl._container_op &mdash; Kubeflow Pipelines  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Kubeflow Pipelines
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../source/kfp.html">kfp package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Kubeflow Pipelines</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>kfp.dsl._container_op</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for kfp.dsl._container_op</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2019 Google LLC</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#      http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">TypeVar</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Sequence</span>

<span class="kn">from</span> <span class="nn">kubernetes.client</span> <span class="kn">import</span> <span class="n">V1Toleration</span><span class="p">,</span> <span class="n">V1Affinity</span>
<span class="kn">from</span> <span class="nn">kubernetes.client.models</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">V1Container</span><span class="p">,</span> <span class="n">V1EnvVar</span><span class="p">,</span> <span class="n">V1EnvFromSource</span><span class="p">,</span> <span class="n">V1SecurityContext</span><span class="p">,</span> <span class="n">V1Probe</span><span class="p">,</span>
    <span class="n">V1ResourceRequirements</span><span class="p">,</span> <span class="n">V1VolumeDevice</span><span class="p">,</span> <span class="n">V1VolumeMount</span><span class="p">,</span> <span class="n">V1ContainerPort</span><span class="p">,</span>
    <span class="n">V1Lifecycle</span><span class="p">,</span> <span class="n">V1Volume</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">_pipeline_param</span>
<span class="kn">from</span> <span class="nn">..components.structures</span> <span class="kn">import</span> <span class="n">ComponentSpec</span><span class="p">,</span> <span class="n">ExecutionOptionsSpec</span><span class="p">,</span> <span class="n">CachingStrategySpec</span>

<span class="c1"># generics</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="c1"># type alias: either a string or a list of string</span>
<span class="n">StringOrStringList</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>


<span class="c1"># util functions</span>
<span class="k">def</span> <span class="nf">deprecation_warning</span><span class="p">(</span><span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">op_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                        <span class="n">container_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Decorator function to give a pending deprecation warning&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_wrapped</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s1">&#39;`dsl.ContainerOp.</span><span class="si">%s</span><span class="s1">` will be removed in future releases. &#39;</span>
            <span class="s1">&#39;Use `dsl.ContainerOp.container.</span><span class="si">%s</span><span class="s1">` instead.&#39;</span> <span class="o">%</span>
            <span class="p">(</span><span class="n">op_name</span><span class="p">,</span> <span class="n">container_name</span><span class="p">),</span> <span class="ne">PendingDeprecationWarning</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_wrapped</span>


<span class="k">def</span> <span class="nf">_create_getter_setter</span><span class="p">(</span><span class="n">prop</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a tuple of getter and setter methods for a property in `Container`.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span>   
    <span class="k">def</span> <span class="nf">_setter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_getter</span><span class="p">,</span> <span class="n">_setter</span>


<span class="k">def</span> <span class="nf">_proxy_container_op_props</span><span class="p">(</span><span class="bp">cls</span><span class="p">:</span> <span class="s2">&quot;ContainerOp&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Takes the `ContainerOp` class and proxy the PendingDeprecation properties</span>
<span class="sd">    in `ContainerOp` to the `Container` instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># properties mapping to proxy: ContainerOps.&lt;prop&gt; =&gt; Container.&lt;prop&gt;</span>
    <span class="n">prop_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="n">env_variables</span><span class="o">=</span><span class="s1">&#39;env&#39;</span><span class="p">)</span>
    <span class="c1"># itera and create class props</span>
    <span class="k">for</span> <span class="n">op_prop</span><span class="p">,</span> <span class="n">container_prop</span> <span class="ow">in</span> <span class="n">prop_map</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># create getter and setter</span>
        <span class="n">_getter</span><span class="p">,</span> <span class="n">_setter</span> <span class="o">=</span> <span class="n">_create_getter_setter</span><span class="p">(</span><span class="n">container_prop</span><span class="p">)</span>
        <span class="c1"># decorate with deprecation warning</span>
        <span class="n">getter</span> <span class="o">=</span> <span class="n">deprecation_warning</span><span class="p">(</span><span class="n">_getter</span><span class="p">,</span> <span class="n">op_prop</span><span class="p">,</span> <span class="n">container_prop</span><span class="p">)</span>
        <span class="n">setter</span> <span class="o">=</span> <span class="n">deprecation_warning</span><span class="p">(</span><span class="n">_setter</span><span class="p">,</span> <span class="n">op_prop</span><span class="p">,</span> <span class="n">container_prop</span><span class="p">)</span>
        <span class="c1"># update attribites with properties</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">op_prop</span><span class="p">,</span> <span class="nb">property</span><span class="p">(</span><span class="n">getter</span><span class="p">,</span> <span class="n">setter</span><span class="p">))</span>
    <span class="k">return</span> <span class="bp">cls</span>


<span class="k">def</span> <span class="nf">as_string_list</span><span class="p">(</span><span class="n">list_or_str</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Any</span><span class="p">]]])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert any value except None to a list if not already a list.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">list_or_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_or_str</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">list_or_str</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">list_value</span> <span class="o">=</span> <span class="n">list_or_str</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">list_value</span> <span class="o">=</span> <span class="p">[</span><span class="n">list_or_str</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">list_value</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">create_and_append</span><span class="p">(</span><span class="n">current_list</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span> <span class="n">item</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Create a list (if needed) and appends an item to it.&quot;&quot;&quot;</span>
    <span class="n">current_list</span> <span class="o">=</span> <span class="n">current_list</span> <span class="ow">or</span> <span class="p">[]</span>
    <span class="n">current_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">current_list</span>


<span class="k">class</span> <span class="nc">Container</span><span class="p">(</span><span class="n">V1Container</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A wrapper over k8s container definition object (io.k8s.api.core.v1.Container),</span>
<span class="sd">    which is used to represent the `container` property in argo&#39;s workflow </span>
<span class="sd">    template (io.argoproj.workflow.v1alpha1.Template).</span>
<span class="sd">    </span>
<span class="sd">    `Container` class also comes with utility functions to set and update the </span>
<span class="sd">    the various properties for a k8s container definition.</span>

<span class="sd">    NOTE: A notable difference is that `name` is not required and will not be </span>
<span class="sd">    processed for `Container` (in contrast to `V1Container` where `name` is a</span>
<span class="sd">    required property). </span>

<span class="sd">    See: </span>
<span class="sd">    - https://github.com/kubernetes-client/python/blob/master/kubernetes/client/models/v1_container.py</span>
<span class="sd">    - https://github.com/argoproj/argo/blob/master/api/openapi-spec/swagger.json</span>

<span class="sd">    </span>
<span class="sd">    Example:</span>

<span class="sd">      from kfp.dsl import ContainerOp</span>
<span class="sd">      from kubernetes.client.models import V1EnvVar</span>
<span class="sd">      </span>

<span class="sd">      # creates a operation</span>
<span class="sd">      op = ContainerOp(name=&#39;bash-ops&#39;, </span>
<span class="sd">                       image=&#39;busybox:latest&#39;, </span>
<span class="sd">                       command=[&#39;echo&#39;], </span>
<span class="sd">                       arguments=[&#39;$MSG&#39;])</span>

<span class="sd">      # returns a `Container` object from `ContainerOp`</span>
<span class="sd">      # and add an environment variable to `Container`</span>
<span class="sd">      op.container.add_env_variable(V1EnvVar(name=&#39;MSG&#39;, value=&#39;hello world&#39;))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes:</span>
<span class="sd">      attribute_map (dict): The key is attribute name</span>
<span class="sd">                            and the value is json key in definition.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># remove `name` from attribute_map, swagger_types and openapi_types so `name` is not generated in the JSON</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">V1Container</span><span class="p">,</span> <span class="s1">&#39;swagger_types&#39;</span><span class="p">):</span>
        <span class="n">swagger_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">V1Container</span><span class="o">.</span><span class="n">swagger_types</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;name&#39;</span>
        <span class="p">}</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">V1Container</span><span class="p">,</span> <span class="s1">&#39;openapi_types&#39;</span><span class="p">):</span>
        <span class="n">openapi_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">V1Container</span><span class="o">.</span><span class="n">openapi_types</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;name&#39;</span>
        <span class="p">}</span>
    <span class="n">attribute_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">key</span><span class="p">:</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">V1Container</span><span class="o">.</span><span class="n">attribute_map</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;name&#39;</span>
    <span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a new instance of `Container`.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            image {str}: image to use, e.g. busybox:latest</span>
<span class="sd">            command {List[str]}: entrypoint array.  Not executed within a shell.</span>
<span class="sd">            args {List[str]}: arguments to entrypoint.</span>
<span class="sd">            **kwargs: keyword arguments for `V1Container`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># set name to &#39;&#39; if name is not provided</span>
        <span class="c1"># k8s container MUST have a name</span>
        <span class="c1"># argo workflow template does not need a name for container def</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">):</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">Container</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_memory_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory_string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Validate a given string is valid for memory request or limit.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">memory_string</span><span class="p">,</span> <span class="n">_pipeline_param</span><span class="o">.</span><span class="n">PipelineParam</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">memory_string</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                <span class="n">memory_string</span> <span class="o">=</span> <span class="n">memory_string</span><span class="o">.</span><span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span>

        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[0-9]+(E|Ei|P|Pi|T|Ti|G|Gi|M|Mi|K|Ki){0,1}$&#39;</span><span class="p">,</span>
                    <span class="n">memory_string</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Invalid memory string. Should be an integer, or integer followed &#39;</span>
                <span class="s1">&#39;by one of &quot;E|Ei|P|Pi|T|Ti|G|Gi|M|Mi|K|Ki&quot;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_cpu_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cpu_string</span><span class="p">):</span>
        <span class="s2">&quot;Validate a given string is valid for cpu request or limit.&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cpu_string</span><span class="p">,</span> <span class="n">_pipeline_param</span><span class="o">.</span><span class="n">PipelineParam</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">cpu_string</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                <span class="n">cpu_string</span> <span class="o">=</span> <span class="n">cpu_string</span><span class="o">.</span><span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span>

        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[0-9]+m$&#39;</span><span class="p">,</span> <span class="n">cpu_string</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">cpu_string</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Invalid cpu string. Should be float or integer, or integer followed &#39;</span>
                <span class="s1">&#39;by &quot;m&quot;.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_positive_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">str_value</span><span class="p">,</span> <span class="n">param_name</span><span class="p">):</span>
        <span class="s2">&quot;Validate a given string is in positive integer format.&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">str_value</span><span class="p">,</span> <span class="n">_pipeline_param</span><span class="o">.</span><span class="n">PipelineParam</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">str_value</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
                <span class="n">str_value</span> <span class="o">=</span> <span class="n">str_value</span><span class="o">.</span><span class="n">value</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">int_value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">str_value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Invalid </span><span class="si">{}</span><span class="s1">. Should be integer.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param_name</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">int_value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> must be positive integer.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">param_name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">add_resource_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add the resource limit of the container.</span>

<span class="sd">        Args:</span>
<span class="sd">          resource_name: The name of the resource. It can be cpu, memory, etc.</span>
<span class="sd">          value: The string value of the limit.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span> <span class="ow">or</span> <span class="n">V1ResourceRequirements</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">limits</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">limits</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">resource_name</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_resource_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource_name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add the resource request of the container.</span>

<span class="sd">        Args:</span>
<span class="sd">          resource_name: The name of the resource. It can be cpu, memory, etc.</span>
<span class="sd">          value: The string value of the request.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">resources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span> <span class="ow">or</span> <span class="n">V1ResourceRequirements</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">requests</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">requests</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resources</span><span class="o">.</span><span class="n">requests</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">resource_name</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_memory_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set memory request (minimum) for this operator.</span>

<span class="sd">        Args:</span>
<span class="sd">          memory: a string which can be a number or a number followed by one of</span>
<span class="sd">                  &quot;E&quot;, &quot;P&quot;, &quot;T&quot;, &quot;G&quot;, &quot;M&quot;, &quot;K&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_memory_string</span><span class="p">(</span><span class="n">memory</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_resource_request</span><span class="p">(</span><span class="s2">&quot;memory&quot;</span><span class="p">,</span> <span class="n">memory</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_memory_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set memory limit (maximum) for this operator.</span>

<span class="sd">        Args:</span>
<span class="sd">          memory: a string which can be a number or a number followed by one of</span>
<span class="sd">                  &quot;E&quot;, &quot;P&quot;, &quot;T&quot;, &quot;G&quot;, &quot;M&quot;, &quot;K&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_memory_string</span><span class="p">(</span><span class="n">memory</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_resource_limit</span><span class="p">(</span><span class="s2">&quot;memory&quot;</span><span class="p">,</span> <span class="n">memory</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_cpu_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cpu</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set cpu request (minimum) for this operator.</span>

<span class="sd">        Args:</span>
<span class="sd">          cpu: A string which can be a number or a number followed by &quot;m&quot;, which means 1/1000.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_cpu_string</span><span class="p">(</span><span class="n">cpu</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_resource_request</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span> <span class="n">cpu</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_cpu_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cpu</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set cpu limit (maximum) for this operator.</span>

<span class="sd">        Args:</span>
<span class="sd">          cpu: A string which can be a number or a number followed by &quot;m&quot;, which means 1/1000.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_cpu_string</span><span class="p">(</span><span class="n">cpu</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_resource_limit</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">,</span> <span class="n">cpu</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_gpu_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpu</span><span class="p">,</span> <span class="n">vendor</span><span class="o">=</span><span class="s2">&quot;nvidia&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set gpu limit for the operator. This function add &#39;&lt;vendor&gt;.com/gpu&#39; into resource limit. </span>
<span class="sd">        Note that there is no need to add GPU request. GPUs are only supposed to be specified in </span>
<span class="sd">        the limits section. See https://kubernetes.io/docs/tasks/manage-gpus/scheduling-gpus/.</span>

<span class="sd">        Args:</span>
<span class="sd">          gpu: A string which must be a positive number.</span>
<span class="sd">          vendor: Optional. A string which is the vendor of the requested gpu. The supported values </span>
<span class="sd">            are: &#39;nvidia&#39; (default), and &#39;amd&#39;. </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_positive_number</span><span class="p">(</span><span class="n">gpu</span><span class="p">,</span> <span class="s1">&#39;gpu&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vendor</span> <span class="o">!=</span> <span class="s1">&#39;nvidia&#39;</span> <span class="ow">and</span> <span class="n">vendor</span> <span class="o">!=</span> <span class="s1">&#39;amd&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;vendor can only be nvidia or amd.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_resource_limit</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.com/gpu&quot;</span> <span class="o">%</span> <span class="n">vendor</span><span class="p">,</span> <span class="n">gpu</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_volume_mount</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">volume_mount</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add volume to the container</span>

<span class="sd">        Args:</span>
<span class="sd">          volume_mount: Kubernetes volume mount</span>
<span class="sd">          For detailed spec, check volume mount definition</span>
<span class="sd">          https://github.com/kubernetes-client/python/blob/master/kubernetes/client/models/v1_volume_mount.py</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">volume_mount</span><span class="p">,</span> <span class="n">V1VolumeMount</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;invalid argument. Must be of instance `V1VolumeMount`.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">volume_mounts</span> <span class="o">=</span> <span class="n">create_and_append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume_mounts</span><span class="p">,</span>
                                               <span class="n">volume_mount</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_volume_devices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">volume_device</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a block device to be used by the container.</span>

<span class="sd">        Args:</span>
<span class="sd">          volume_device: Kubernetes volume device</span>
<span class="sd">          For detailed spec, volume device definition</span>
<span class="sd">          https://github.com/kubernetes-client/python/blob/master/kubernetes/client/models/v1_volume_device.py</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">volume_device</span><span class="p">,</span> <span class="n">V1VolumeDevice</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;invalid argument. Must be of instance `V1VolumeDevice`.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">volume_devices</span> <span class="o">=</span> <span class="n">create_and_append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume_devices</span><span class="p">,</span>
                                                <span class="n">volume_device</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_env_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env_variable</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add environment variable to the container.</span>

<span class="sd">        Args:</span>
<span class="sd">          env_variable: Kubernetes environment variable</span>
<span class="sd">          For detailed spec, check environment variable definition</span>
<span class="sd">          https://github.com/kubernetes-client/python/blob/master/kubernetes/client/models/v1_env_var.py</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env_variable</span><span class="p">,</span> <span class="n">V1EnvVar</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;invalid argument. Must be of instance `V1EnvVar`.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">create_and_append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">,</span> <span class="n">env_variable</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_env_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env_from</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a source to populate environment variables int the container.</span>

<span class="sd">        Args:</span>
<span class="sd">          env_from: Kubernetes environment from source</span>
<span class="sd">          For detailed spec, check environment from source definition</span>
<span class="sd">          https://github.com/kubernetes-client/python/blob/master/kubernetes/client/models/v1_env_var_source.py</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">env_from</span><span class="p">,</span> <span class="n">V1EnvFromSource</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;invalid argument. Must be of instance `V1EnvFromSource`.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">env_from</span> <span class="o">=</span> <span class="n">create_and_append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env_from</span><span class="p">,</span> <span class="n">env_from</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_image_pull_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image_pull_policy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set image pull policy for the container.</span>

<span class="sd">        Args:</span>
<span class="sd">          image_pull_policy: One of `Always`, `Never`, `IfNotPresent`. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">image_pull_policy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Always&#39;</span><span class="p">,</span> <span class="s1">&#39;Never&#39;</span><span class="p">,</span> <span class="s1">&#39;IfNotPresent&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Invalid imagePullPolicy. Must be one of `Always`, `Never`, `IfNotPresent`.&#39;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">image_pull_policy</span> <span class="o">=</span> <span class="n">image_pull_policy</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_port</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">container_port</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a container port to the container.</span>

<span class="sd">        Args:</span>
<span class="sd">          container_port: Kubernetes container port</span>
<span class="sd">          For detailed spec, check container port definition</span>
<span class="sd">          https://github.com/kubernetes-client/python/blob/master/kubernetes/client/models/v1_container_port.py</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">container_port</span><span class="p">,</span> <span class="n">V1ContainerPort</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;invalid argument. Must be of instance `V1ContainerPort`.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ports</span> <span class="o">=</span> <span class="n">create_and_append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ports</span><span class="p">,</span> <span class="n">container_port</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_security_context</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">security_context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set security configuration to be applied on the container.  </span>

<span class="sd">        Args:</span>
<span class="sd">          security_context: Kubernetes security context</span>
<span class="sd">          For detailed spec, check security context definition</span>
<span class="sd">          https://github.com/kubernetes-client/python/blob/master/kubernetes/client/models/v1_security_context.py</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">security_context</span><span class="p">,</span> <span class="n">V1SecurityContext</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;invalid argument. Must be of instance `V1SecurityContext`.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">security_context</span> <span class="o">=</span> <span class="n">security_context</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_stdin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether this container should allocate a buffer for stdin in the container </span>
<span class="sd">        runtime. If this is not set, reads from stdin in the container will always </span>
<span class="sd">        result in EOF.</span>

<span class="sd">        Args:</span>
<span class="sd">          stdin: boolean flag</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stdin</span> <span class="o">=</span> <span class="n">stdin</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_stdin_once</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stdin_once</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether the container runtime should close the stdin channel after it has </span>
<span class="sd">        been opened by a single attach. When stdin is true the stdin stream will </span>
<span class="sd">        remain open across multiple attach sessions. If stdinOnce is set to true, </span>
<span class="sd">        stdin is opened on container start, is empty until the first client attaches </span>
<span class="sd">        to stdin, and then remains open and accepts data until the client </span>
<span class="sd">        disconnects, at which time stdin is closed and remains closed until the </span>
<span class="sd">        container is restarted. If this flag is false, a container processes that </span>
<span class="sd">        reads from stdin will never receive an EOF. </span>

<span class="sd">        Args:</span>
<span class="sd">          stdin_once: boolean flag</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stdin_once</span> <span class="o">=</span> <span class="n">stdin_once</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_termination_message_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">termination_message_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Path at which the file to which the container&#39;s termination message will be </span>
<span class="sd">        written is mounted into the container&#39;s filesystem. Message written is </span>
<span class="sd">        intended to be brief final status, such as an assertion failure message. </span>
<span class="sd">        Will be truncated by the node if greater than 4096 bytes. The total message </span>
<span class="sd">        length across all containers will be limited to 12kb. </span>

<span class="sd">        Args:</span>
<span class="sd">          termination_message_path: path for the termination message</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">termination_message_path</span> <span class="o">=</span> <span class="n">termination_message_path</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_termination_message_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">termination_message_policy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Indicate how the termination message should be populated. File will use the </span>
<span class="sd">        contents of terminationMessagePath to populate the container status message </span>
<span class="sd">        on both success and failure. FallbackToLogsOnError will use the last chunk </span>
<span class="sd">        of container log output if the termination message file is empty and the </span>
<span class="sd">        container exited with an error. The log output is limited to 2048 bytes or </span>
<span class="sd">        80 lines, whichever is smaller.</span>

<span class="sd">        Args:</span>
<span class="sd">          termination_message_policy: `File` or `FallbackToLogsOnError`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">termination_message_policy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;File&#39;</span><span class="p">,</span> <span class="s1">&#39;FallbackToLogsOnError&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;terminationMessagePolicy must be `File` or `FallbackToLogsOnError`&#39;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">termination_message_policy</span> <span class="o">=</span> <span class="n">termination_message_policy</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_tty</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tty</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether this container should allocate a TTY for itself, also requires </span>
<span class="sd">        &#39;stdin&#39; to be true.</span>

<span class="sd">        Args:</span>
<span class="sd">          tty: boolean flag</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tty</span> <span class="o">=</span> <span class="n">tty</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_readiness_probe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">readiness_probe</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a readiness probe for the container.</span>

<span class="sd">        Args:</span>
<span class="sd">          readiness_probe: Kubernetes readiness probe</span>
<span class="sd">          For detailed spec, check probe definition</span>
<span class="sd">          https://github.com/kubernetes-client/python/blob/master/kubernetes/client/models/v1_probe.py</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">readiness_probe</span><span class="p">,</span> <span class="n">V1Probe</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;invalid argument. Must be of instance `V1Probe`.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">readiness_probe</span> <span class="o">=</span> <span class="n">readiness_probe</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_liveness_probe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">liveness_probe</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set a liveness probe for the container.</span>

<span class="sd">        Args:</span>
<span class="sd">          liveness_probe: Kubernetes liveness probe</span>
<span class="sd">          For detailed spec, check probe definition</span>
<span class="sd">          https://github.com/kubernetes-client/python/blob/master/kubernetes/client/models/v1_probe.py</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">liveness_probe</span><span class="p">,</span> <span class="n">V1Probe</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;invalid argument. Must be of instance `V1Probe`.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">liveness_probe</span> <span class="o">=</span> <span class="n">liveness_probe</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_lifecycle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lifecycle</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setup a lifecycle config for the container.</span>

<span class="sd">        Args:</span>
<span class="sd">          lifecycle: Kubernetes lifecycle</span>
<span class="sd">          For detailed spec, lifecycle definition</span>
<span class="sd">          https://github.com/kubernetes-client/python/blob/master/kubernetes/client/models/v1_lifecycle.py</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lifecycle</span><span class="p">,</span> <span class="n">V1Lifecycle</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;invalid argument. Must be of instance `V1Lifecycle`.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lifecycle</span> <span class="o">=</span> <span class="n">lifecycle</span>
        <span class="k">return</span> <span class="bp">self</span>


<div class="viewcode-block" id="UserContainer"><a class="viewcode-back" href="../../../source/kfp.dsl.html#kfp.dsl.UserContainer">[docs]</a><span class="k">class</span> <span class="nc">UserContainer</span><span class="p">(</span><span class="n">Container</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents an argo workflow UserContainer (io.argoproj.workflow.v1alpha1.UserContainer)</span>
<span class="sd">    to be used in `UserContainer` property in argo&#39;s workflow template</span>
<span class="sd">    (io.argoproj.workflow.v1alpha1.Template).</span>

<span class="sd">    `UserContainer` inherits from `Container` class with an addition of `mirror_volume_mounts`</span>
<span class="sd">    attribute (`mirrorVolumeMounts` property).</span>

<span class="sd">    See https://github.com/argoproj/argo/blob/master/api/openapi-spec/swagger.json</span>

<span class="sd">    Example</span>

<span class="sd">        from kfp.dsl import ContainerOp, UserContainer</span>

<span class="sd">        # creates a `ContainerOp` and adds a redis init container</span>
<span class="sd">        op = (ContainerOp(name=&#39;foo-op&#39;, image=&#39;busybox:latest&#39;)</span>
<span class="sd">                .add_initContainer(</span>
<span class="sd">                    UserContainer(name=&#39;redis&#39;, image=&#39;redis:alpine&#39;)))</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attributes:</span>
<span class="sd">      swagger_types (dict): The key is attribute name</span>
<span class="sd">                            and the value is attribute type.</span>
<span class="sd">      attribute_map (dict): The key is attribute name</span>
<span class="sd">                            and the value is json key in definition.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># adds `mirror_volume_mounts` to `UserContainer` swagger definition</span>
    <span class="c1"># NOTE inherits definition from `V1Container` rather than `Container`</span>
    <span class="c1">#      because `Container` has no `name` property.</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">V1Container</span><span class="p">,</span> <span class="s1">&#39;swagger_types&#39;</span><span class="p">):</span>
        <span class="n">swagger_types</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="o">**</span><span class="n">V1Container</span><span class="o">.</span><span class="n">swagger_types</span><span class="p">,</span> <span class="n">mirror_volume_mounts</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">V1Container</span><span class="p">,</span> <span class="s1">&#39;openapi_types&#39;</span><span class="p">):</span>
        <span class="n">openapi_types</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="o">**</span><span class="n">V1Container</span><span class="o">.</span><span class="n">openapi_types</span><span class="p">,</span> <span class="n">mirror_volume_mounts</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">)</span>
    <span class="n">attribute_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="o">**</span><span class="n">V1Container</span><span class="o">.</span><span class="n">attribute_map</span><span class="p">,</span> <span class="n">mirror_volume_mounts</span><span class="o">=</span><span class="s1">&#39;mirrorVolumeMounts&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">StringOrStringList</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="n">StringOrStringList</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">mirror_volume_mounts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a new instance of `UserContainer`.</span>

<span class="sd">        Args:</span>
<span class="sd">            name {str}: unique name for the user container</span>
<span class="sd">            image {str}: image to use for the user container, e.g. redis:alpine</span>
<span class="sd">            command {StringOrStringList}: entrypoint array.  Not executed within a shell.</span>
<span class="sd">            args {StringOrStringList}: arguments to the entrypoint.</span>
<span class="sd">            mirror_volume_mounts {bool}: MirrorVolumeMounts will mount the same</span>
<span class="sd">                volumes specified in the main container to the container (including artifacts),</span>
<span class="sd">                at the same mountPaths. This enables dind daemon to partially see the same</span>
<span class="sd">                filesystem as the main container in order to use features such as docker</span>
<span class="sd">                volume binding</span>
<span class="sd">            **kwargs: keyword arguments available for `Container`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="n">as_string_list</span><span class="p">(</span><span class="n">command</span><span class="p">),</span>
            <span class="n">args</span><span class="o">=</span><span class="n">as_string_list</span><span class="p">(</span><span class="n">args</span><span class="p">),</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror_volume_mounts</span> <span class="o">=</span> <span class="n">mirror_volume_mounts</span>

<div class="viewcode-block" id="UserContainer.set_mirror_volume_mounts"><a class="viewcode-back" href="../../../source/kfp.dsl.html#kfp.dsl.UserContainer.set_mirror_volume_mounts">[docs]</a>    <span class="k">def</span> <span class="nf">set_mirror_volume_mounts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mirror_volume_mounts</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setting mirrorVolumeMounts to true will mount the same volumes specified</span>
<span class="sd">        in the main container to the container (including artifacts), at the same</span>
<span class="sd">        mountPaths. This enables dind daemon to partially see the same filesystem</span>
<span class="sd">        as the main container in order to use features such as docker volume</span>
<span class="sd">        binding.</span>

<span class="sd">        Args:</span>
<span class="sd">            mirror_volume_mounts: boolean flag</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mirror_volume_mounts</span> <span class="o">=</span> <span class="n">mirror_volume_mounts</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A list of PipelineParam found in the UserContainer object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_pipeline_param</span><span class="o">.</span><span class="n">extract_pipelineparams_from_any</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sidecar"><a class="viewcode-back" href="../../../source/kfp.dsl.html#kfp.dsl.Sidecar">[docs]</a><span class="k">class</span> <span class="nc">Sidecar</span><span class="p">(</span><span class="n">UserContainer</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">command</span><span class="p">:</span> <span class="n">StringOrStringList</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">args</span><span class="p">:</span> <span class="n">StringOrStringList</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">mirror_volume_mounts</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates a new instance of `Sidecar`.</span>

<span class="sd">        Args:</span>
<span class="sd">            name {str}: unique name for the sidecar container</span>
<span class="sd">            image {str}: image to use for the sidecar container, e.g. redis:alpine</span>
<span class="sd">            command {StringOrStringList}: entrypoint array.  Not executed within a shell.</span>
<span class="sd">            args {StringOrStringList}: arguments to the entrypoint.</span>
<span class="sd">            mirror_volume_mounts {bool}: MirrorVolumeMounts will mount the same</span>
<span class="sd">                volumes specified in the main container to the sidecar (including artifacts),</span>
<span class="sd">                at the same mountPaths. This enables dind daemon to partially see the same</span>
<span class="sd">                filesystem as the main container in order to use features such as docker</span>
<span class="sd">                volume binding</span>
<span class="sd">            **kwargs: keyword arguments available for `Container`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span>
            <span class="n">mirror_volume_mounts</span><span class="o">=</span><span class="n">mirror_volume_mounts</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_make_hash_based_id_for_op</span><span class="p">(</span><span class="n">op</span><span class="p">):</span>
    <span class="c1"># Generating a unique ID for Op. For class instances, the hash is the object&#39;s memory address which is unique.</span>
    <span class="k">return</span> <span class="n">op</span><span class="o">.</span><span class="n">human_name</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">63</span> <span class="o">+</span> <span class="nb">hash</span><span class="p">(</span><span class="n">op</span><span class="p">))[</span><span class="mi">2</span><span class="p">:]</span>


<span class="c1"># Pointer to a function that generates a unique ID for the Op instance (Possibly by registering the Op instance in some system).</span>
<span class="n">_register_op_handler</span> <span class="o">=</span> <span class="n">_make_hash_based_id_for_op</span>


<span class="k">class</span> <span class="nc">BaseOp</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="c1"># list of attributes that might have pipeline params - used to generate</span>
    <span class="c1"># the input parameters during compilation.</span>
    <span class="c1"># Excludes `file_outputs` and `outputs` as they are handled separately</span>
    <span class="c1"># in the compilation process to generate the DAGs and task io parameters.</span>
    <span class="n">attrs_with_pipelineparams</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;node_selector&#39;</span><span class="p">,</span> <span class="s1">&#39;volumes&#39;</span><span class="p">,</span> <span class="s1">&#39;pod_annotations&#39;</span><span class="p">,</span> <span class="s1">&#39;pod_labels&#39;</span><span class="p">,</span>
        <span class="s1">&#39;num_retries&#39;</span><span class="p">,</span> <span class="s1">&#39;init_containers&#39;</span><span class="p">,</span> <span class="s1">&#39;sidecars&#39;</span><span class="p">,</span> <span class="s1">&#39;tolerations&#39;</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="n">init_containers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">UserContainer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">sidecars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Sidecar</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">is_exit_handler</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new instance of BaseOp</span>

<span class="sd">        Args:</span>
<span class="sd">          name: the name of the op. It does not have to be unique within a pipeline</span>
<span class="sd">              because the pipeline will generates a unique new name in case of conflicts.</span>
<span class="sd">          init_containers: the list of `InitContainer` objects describing the InitContainer</span>
<span class="sd">                    to deploy before the `main` container.</span>
<span class="sd">          sidecars: the list of `Sidecar` objects describing the sidecar containers to deploy</span>
<span class="sd">                    together with the `main` container.</span>
<span class="sd">          is_exit_handler: Deprecated.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">valid_name_regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;^[A-Za-z][A-Za-z0-9\s_-]*$&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">valid_name_regex</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;Only letters, numbers, spaces, &quot;_&quot;, and &quot;-&quot;  are allowed in name. Must begin with letter: </span><span class="si">%s</span><span class="s1">&#39;</span>
                <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">is_exit_handler</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;is_exit_handler=True is no longer needed.&#39;</span><span class="p">,</span> <span class="ne">DeprecationWarning</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_exit_handler</span> <span class="o">=</span> <span class="n">is_exit_handler</span>

        <span class="c1"># human_name must exist to construct operator&#39;s name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">human_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">display_name</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1">#TODO Set display_name to human_name</span>
        <span class="c1"># ID of the current Op. Ideally, it should be generated by the compiler that sees the bigger context.</span>
        <span class="c1"># However, the ID is used in the task output references (PipelineParams) which can be serialized to strings.</span>
        <span class="c1"># Because of this we must obtain a unique ID right now.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">_register_op_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># TODO: proper k8s definitions so that `convert_k8s_obj_to_json` can be used?</span>
        <span class="c1"># `io.argoproj.workflow.v1alpha1.Template` properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_selector</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volumes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">affinity</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pod_annotations</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pod_labels</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_retries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_containers</span> <span class="o">=</span> <span class="n">init_containers</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sidecars</span> <span class="o">=</span> <span class="n">sidecars</span> <span class="ow">or</span> <span class="p">[]</span>

        <span class="c1"># used to mark this op with loop arguments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loop_args</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># attributes specific to `BaseOp`</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_inputs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dependent_names</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;List of PipelineParams that will be converted into input parameters</span>
<span class="sd">        (io.argoproj.workflow.v1alpha1.Inputs) for the argo workflow.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Iterate through and extract all the `PipelineParam` in Op when</span>
        <span class="c1"># called the 1st time (because there are in-place updates to `PipelineParam`</span>
        <span class="c1"># during compilation - remove in-place updates for easier debugging?)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inputs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inputs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># TODO replace with proper k8s obj?</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">attrs_with_pipelineparams</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_inputs</span> <span class="o">+=</span> <span class="n">_pipeline_param</span><span class="o">.</span><span class="n">extract_pipelineparams_from_any</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
            <span class="c1"># keep only unique</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_inputs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_inputs</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_inputs</span>

    <span class="nd">@inputs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="c1"># to support in-place updates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_inputs</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mod_func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Applies a modifier function to self. The function should return the passed object.</span>
<span class="sd">        This is needed to chain &quot;extention methods&quot; to this class.</span>

<span class="sd">        Example:</span>
<span class="sd">          from kfp.gcp import use_gcp_secret</span>
<span class="sd">          task = (</span>
<span class="sd">            train_op(...)</span>
<span class="sd">              .set_memory_request(&#39;1G&#39;)</span>
<span class="sd">              .apply(use_gcp_secret(&#39;user-gcp-sa&#39;))</span>
<span class="sd">              .set_memory_limit(&#39;2G&#39;)</span>
<span class="sd">          )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">mod_func</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">after</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">ops</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Specify explicit dependency on other ops.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">ops</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dependent_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">volume</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add K8s volume to the container</span>

<span class="sd">        Args:</span>
<span class="sd">          volume: Kubernetes volumes</span>
<span class="sd">          For detailed spec, check volume definition</span>
<span class="sd">          https://github.com/kubernetes-client/python/blob/master/kubernetes/client/models/v1_volume.py</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volumes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_toleration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tolerations</span><span class="p">:</span> <span class="n">V1Toleration</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add K8s tolerations</span>

<span class="sd">        Args:</span>
<span class="sd">          tolerations: Kubernetes toleration</span>
<span class="sd">          For detailed spec, check toleration definition</span>
<span class="sd">          https://github.com/kubernetes-client/python/blob/master/kubernetes/client/models/v1_toleration.py</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tolerations</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_affinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">affinity</span><span class="p">:</span> <span class="n">V1Affinity</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add K8s Affinity</span>
<span class="sd">        Args:</span>
<span class="sd">          affinity: Kubernetes affinity</span>
<span class="sd">          For detailed spec, check affinity definition</span>
<span class="sd">          https://github.com/kubernetes-client/python/blob/master/kubernetes/client/models/v1_affinity.py</span>
<span class="sd">          example: V1Affinity(</span>
<span class="sd">                    node_affinity=V1NodeAffinity(</span>
<span class="sd">                        required_during_scheduling_ignored_during_execution=V1NodeSelector(</span>
<span class="sd">                            node_selector_terms=[V1NodeSelectorTerm(</span>
<span class="sd">                                match_expressions=[V1NodeSelectorRequirement(</span>
<span class="sd">                                    key=&#39;beta.kubernetes.io/instance-type&#39;, operator=&#39;In&#39;, values=[&#39;p2.xlarge&#39;])])])))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">affinity</span> <span class="o">=</span> <span class="n">affinity</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_node_selector_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label_name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a constraint for nodeSelector. Each constraint is a key-value pair label. For the </span>
<span class="sd">        container to be eligible to run on a node, the node must have each of the constraints appeared</span>
<span class="sd">        as labels.</span>

<span class="sd">        Args:</span>
<span class="sd">          label_name: The name of the constraint label.</span>
<span class="sd">          value: The value of the constraint label.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">node_selector</span><span class="p">[</span><span class="n">label_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_pod_annotation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a pod&#39;s metadata annotation.</span>

<span class="sd">        Args:</span>
<span class="sd">          name: The name of the annotation.</span>
<span class="sd">          value: The value of the annotation.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pod_annotations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_pod_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds a pod&#39;s metadata label.</span>

<span class="sd">        Args:</span>
<span class="sd">          name: The name of the label.</span>
<span class="sd">          value: The value of the label.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pod_labels</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_retry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_retries</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the number of times the task is retried until it&#39;s declared failed.</span>

<span class="sd">        Args:</span>
<span class="sd">          num_retries: Number of times to retry on failures.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">num_retries</span> <span class="o">=</span> <span class="n">num_retries</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seconds</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets the timeout for the task in seconds.</span>

<span class="sd">        Args:</span>
<span class="sd">          seconds: Number of seconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">seconds</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_init_container</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">init_container</span><span class="p">:</span> <span class="n">UserContainer</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a init container to the Op.</span>

<span class="sd">        Args:</span>
<span class="sd">          init_container: InitContainer object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_containers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">init_container</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">add_sidecar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sidecar</span><span class="p">:</span> <span class="n">Sidecar</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a sidecar to the Op.</span>

<span class="sd">        Args:</span>
<span class="sd">          sidecar: SideCar object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sidecars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sidecar</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">set_display_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">display_name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">})</span>


<span class="kn">from</span> <span class="nn">._pipeline_volume</span> <span class="kn">import</span> <span class="n">PipelineVolume</span>  <span class="c1"># The import is here to prevent circular reference problems.</span>


<div class="viewcode-block" id="InputArgumentPath"><a class="viewcode-back" href="../../../source/kfp.dsl.html#kfp.dsl.InputArgumentPath">[docs]</a><span class="k">class</span> <span class="nc">InputArgumentPath</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">argument</span> <span class="o">=</span> <span class="n">argument</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input</span> <span class="o">=</span> <span class="nb">input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span></div>


<div class="viewcode-block" id="ContainerOp"><a class="viewcode-back" href="../../../source/kfp.dsl.html#kfp.dsl.ContainerOp">[docs]</a><span class="k">class</span> <span class="nc">ContainerOp</span><span class="p">(</span><span class="n">BaseOp</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Represents an op implemented by a container image.</span>
<span class="sd">    </span>
<span class="sd">    Example::</span>

<span class="sd">        from kfp import dsl</span>
<span class="sd">        from kubernetes.client.models import V1EnvVar, V1SecretKeySelector</span>


<span class="sd">        @dsl.pipeline(</span>
<span class="sd">            name=&#39;foo&#39;,</span>
<span class="sd">            description=&#39;hello world&#39;)</span>
<span class="sd">        def foo_pipeline(tag: str, pull_image_policy: str):</span>

<span class="sd">            # any attributes can be parameterized (both serialized string or actual PipelineParam)</span>
<span class="sd">            op = dsl.ContainerOp(name=&#39;foo&#39;, </span>
<span class="sd">                                image=&#39;busybox:%s&#39; % tag,</span>
<span class="sd">                                # pass in init_container list</span>
<span class="sd">                                init_containers=[dsl.InitContainer(&#39;print&#39;, &#39;busybox:latest&#39;, command=&#39;echo &quot;hello&quot;&#39;)],</span>
<span class="sd">                                # pass in sidecars list</span>
<span class="sd">                                sidecars=[dsl.Sidecar(&#39;print&#39;, &#39;busybox:latest&#39;, command=&#39;echo &quot;hello&quot;&#39;)],</span>
<span class="sd">                                # pass in k8s container kwargs</span>
<span class="sd">                                container_kwargs={&#39;env&#39;: [V1EnvVar(&#39;foo&#39;, &#39;bar&#39;)]},</span>
<span class="sd">            )</span>

<span class="sd">            # set `imagePullPolicy` property for `container` with `PipelineParam` </span>
<span class="sd">            op.container.set_image_pull_policy(pull_image_policy)</span>

<span class="sd">            # add sidecar with parameterized image tag</span>
<span class="sd">            # sidecar follows the argo sidecar swagger spec</span>
<span class="sd">            op.add_sidecar(dsl.Sidecar(&#39;redis&#39;, &#39;redis:%s&#39; % tag).set_image_pull_policy(&#39;Always&#39;))</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># list of attributes that might have pipeline params - used to generate</span>
    <span class="c1"># the input parameters during compilation.</span>
    <span class="c1"># Excludes `file_outputs` and `outputs` as they are handled separately</span>
    <span class="c1"># in the compilation process to generate the DAGs and task io parameters.</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
      <span class="bp">self</span><span class="p">,</span>
      <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
      <span class="n">image</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
      <span class="n">command</span><span class="p">:</span> <span class="n">StringOrStringList</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
      <span class="n">arguments</span><span class="p">:</span> <span class="n">StringOrStringList</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
      <span class="n">init_containers</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">UserContainer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
      <span class="n">sidecars</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Sidecar</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
      <span class="n">container_kwargs</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
      <span class="n">artifact_argument_paths</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">InputArgumentPath</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
      <span class="n">file_outputs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
      <span class="n">output_artifact_paths</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
      <span class="n">is_exit_handler</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
      <span class="n">pvolumes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">V1Volume</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new instance of ContainerOp.</span>

<span class="sd">        Args:</span>
<span class="sd">          name: the name of the op. It does not have to be unique within a pipeline</span>
<span class="sd">              because the pipeline will generates a unique new name in case of conflicts.</span>
<span class="sd">          image: the container image name, such as &#39;python:3.5-jessie&#39;</span>
<span class="sd">          command: the command to run in the container.</span>
<span class="sd">              If None, uses default CMD in defined in container.</span>
<span class="sd">          arguments: the arguments of the command. The command can include &quot;%s&quot; and supply</span>
<span class="sd">              a PipelineParam as the string replacement. For example, (&#39;echo %s&#39; % input_param).</span>
<span class="sd">              At container run time the argument will be &#39;echo param_value&#39;.</span>
<span class="sd">          init_containers: the list of `InitContainer` objects describing the InitContainer</span>
<span class="sd">                    to deploy before the `main` container.</span>
<span class="sd">          sidecars: the list of `Sidecar` objects describing the sidecar containers to deploy</span>
<span class="sd">                    together with the `main` container.</span>
<span class="sd">          container_kwargs: the dict of additional keyword arguments to pass to the</span>
<span class="sd">                            op&#39;s `Container` definition.</span>
<span class="sd">          artifact_argument_paths: Optional. Maps input artifact arguments (values or references) to the local file paths where they&#39;ll be placed.</span>
<span class="sd">              At pipeline run time, the value of the artifact argument is saved to a local file with specified path.</span>
<span class="sd">              This parameter is only needed when the input file paths are hard-coded in the program.</span>
<span class="sd">              Otherwise it&#39;s better to pass input artifact placement paths by including artifact arguments in the command-line using the InputArgumentPath class instances.</span>
<span class="sd">          file_outputs: Maps output labels to local file paths. At pipeline run time,</span>
<span class="sd">              the value of a PipelineParam is saved to its corresponding local file. It&#39;s</span>
<span class="sd">              one way for outside world to receive outputs of the container.</span>
<span class="sd">          output_artifact_paths: Maps output artifact labels to local artifact file paths.</span>
<span class="sd">              It has the following default artifact paths during compile time.</span>
<span class="sd">              {&#39;mlpipeline-ui-metadata&#39;: &#39;/mlpipeline-ui-metadata.json&#39;,</span>
<span class="sd">               &#39;mlpipeline-metrics&#39;: &#39;/mlpipeline-metrics.json&#39;}</span>
<span class="sd">          is_exit_handler: Deprecated. This is no longer needed.</span>
<span class="sd">          pvolumes: Dictionary for the user to match a path on the op&#39;s fs with a</span>
<span class="sd">              V1Volume or it inherited type.</span>
<span class="sd">              E.g {&quot;/my/path&quot;: vol, &quot;/mnt&quot;: other_op.pvolumes[&quot;/output&quot;]}.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">init_containers</span><span class="o">=</span><span class="n">init_containers</span><span class="p">,</span> <span class="n">sidecars</span><span class="o">=</span><span class="n">sidecars</span><span class="p">,</span> <span class="n">is_exit_handler</span><span class="o">=</span><span class="n">is_exit_handler</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrs_with_pipelineparams</span> <span class="o">=</span> <span class="n">BaseOp</span><span class="o">.</span><span class="n">attrs_with_pipelineparams</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;_container&#39;</span><span class="p">,</span> <span class="s1">&#39;artifact_arguments&#39;</span><span class="p">]</span> <span class="c1">#Copying the BaseOp class variable!</span>

        <span class="n">input_artifact_paths</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">artifact_arguments</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">file_outputs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">file_outputs</span> <span class="ow">or</span> <span class="p">{})</span> <span class="c1"># Making a copy</span>
        <span class="n">output_artifact_paths</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">output_artifact_paths</span> <span class="ow">or</span> <span class="p">{})</span> <span class="c1"># Making a copy</span>

        <span class="k">def</span> <span class="nf">resolve_artifact_argument</span><span class="p">(</span><span class="n">artarg</span><span class="p">):</span>
            <span class="kn">from</span> <span class="nn">..components._components</span> <span class="kn">import</span> <span class="n">_generate_input_file_name</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">artarg</span><span class="p">,</span> <span class="n">InputArgumentPath</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">artarg</span>
            <span class="n">input_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">artarg</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">artarg</span><span class="o">.</span><span class="n">input</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;input-&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">artifact_arguments</span><span class="p">)))</span>
            <span class="n">input_path</span> <span class="o">=</span> <span class="n">artarg</span><span class="o">.</span><span class="n">path</span> <span class="ow">or</span> <span class="n">_generate_input_file_name</span><span class="p">(</span><span class="n">input_name</span><span class="p">)</span>
            <span class="n">input_artifact_paths</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_path</span>
            <span class="n">artifact_arguments</span><span class="p">[</span><span class="n">input_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">artarg</span><span class="o">.</span><span class="n">argument</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">input_path</span>

        <span class="k">for</span> <span class="n">artarg</span> <span class="ow">in</span> <span class="n">artifact_argument_paths</span> <span class="ow">or</span> <span class="p">[]:</span>
            <span class="n">resolve_artifact_argument</span><span class="p">(</span><span class="n">artarg</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">command</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">resolve_artifact_argument</span><span class="p">,</span> <span class="n">command</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arguments</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">arguments</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">resolve_artifact_argument</span><span class="p">,</span> <span class="n">arguments</span><span class="p">))</span>

        <span class="c1"># convert to list if not a list</span>
        <span class="n">command</span> <span class="o">=</span> <span class="n">as_string_list</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="n">as_string_list</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span>

        <span class="c1"># `container` prop in `io.argoproj.workflow.v1alpha1.Template`</span>
        <span class="n">container_kwargs</span> <span class="o">=</span> <span class="n">container_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span> <span class="o">=</span> <span class="n">Container</span><span class="p">(</span>
            <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">arguments</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">,</span> <span class="o">**</span><span class="n">container_kwargs</span><span class="p">)</span>

        <span class="c1"># NOTE for backward compatibility (remove in future?)</span>
        <span class="c1"># proxy old ContainerOp callables to Container</span>

        <span class="c1"># attributes to NOT proxy</span>
        <span class="n">ignore_set</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">([</span><span class="s1">&#39;to_dict&#39;</span><span class="p">,</span> <span class="s1">&#39;to_str&#39;</span><span class="p">])</span>

        <span class="c1"># decorator func to proxy a method in `Container` into `ContainerOp`</span>
        <span class="k">def</span> <span class="nf">_proxy</span><span class="p">(</span><span class="n">proxy_attr</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Decorator func to proxy to ContainerOp.container&quot;&quot;&quot;</span>

            <span class="k">def</span> <span class="nf">_decorated</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                <span class="c1"># execute method</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">,</span> <span class="n">proxy_attr</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ret</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span>
                <span class="k">return</span> <span class="n">ret</span>

            <span class="k">return</span> <span class="n">deprecation_warning</span><span class="p">(</span><span class="n">_decorated</span><span class="p">,</span> <span class="n">proxy_attr</span><span class="p">,</span> <span class="n">proxy_attr</span><span class="p">)</span>

        <span class="c1"># iter thru container and attach a proxy func to the container method</span>
        <span class="k">for</span> <span class="n">attr_to_proxy</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">):</span>
            <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="p">,</span> <span class="n">attr_to_proxy</span><span class="p">)</span>
            <span class="c1"># ignore private methods</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">attr_to_proxy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="n">attr_to_proxy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ignore_set</span><span class="p">):</span>
                <span class="c1"># only proxy public callables</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr_to_proxy</span><span class="p">,</span> <span class="n">_proxy</span><span class="p">(</span><span class="n">attr_to_proxy</span><span class="p">))</span>

        <span class="c1"># Special handling for the mlpipeline-ui-metadata and mlpipeline-metrics outputs that should always be saved as artifacts</span>
        <span class="c1"># TODO: Remove when outputs are always saved as artifacts</span>
        <span class="k">for</span> <span class="n">output_name</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">dict</span><span class="p">(</span><span class="n">file_outputs</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">normalized_output_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;[^a-zA-Z0-9]&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">output_name</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">normalized_output_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mlpipeline-ui-metadata&#39;</span><span class="p">,</span> <span class="s1">&#39;mlpipeline-metrics&#39;</span><span class="p">]:</span>
                <span class="n">output_artifact_paths</span><span class="p">[</span><span class="n">normalized_output_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">path</span>
                <span class="k">del</span> <span class="n">file_outputs</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span>

        <span class="c1"># attributes specific to `ContainerOp`</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_artifact_paths</span> <span class="o">=</span> <span class="n">input_artifact_paths</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">artifact_arguments</span> <span class="o">=</span> <span class="n">artifact_arguments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_outputs</span> <span class="o">=</span> <span class="n">file_outputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_artifact_paths</span> <span class="o">=</span> <span class="n">output_artifact_paths</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">execution_options</span> <span class="o">=</span> <span class="n">ExecutionOptionsSpec</span><span class="p">(</span>
            <span class="n">caching_strategy</span><span class="o">=</span><span class="n">CachingStrategySpec</span><span class="p">(),</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">file_outputs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">name</span><span class="p">:</span> <span class="n">_pipeline_param</span><span class="o">.</span><span class="n">PipelineParam</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">op_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">file_outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
            <span class="p">}</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">_MultipleOutputsError</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pvolumes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_pvolumes</span><span class="p">(</span><span class="n">pvolumes</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">command</span>

    <span class="nd">@command</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">command</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">as_string_list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">args</span>

    <span class="nd">@arguments</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">arguments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">as_string_list</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">container</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;`Container` object that represents the `container` property in </span>
<span class="sd">        `io.argoproj.workflow.v1alpha1.Template`. Can be used to update the</span>
<span class="sd">        container configurations. </span>
<span class="sd">        </span>
<span class="sd">        Example:</span>
<span class="sd">            import kfp.dsl as dsl</span>
<span class="sd">            from kubernetes.client.models import V1EnvVar</span>
<span class="sd">    </span>
<span class="sd">            @dsl.pipeline(name=&#39;example_pipeline&#39;)</span>
<span class="sd">            def immediate_value_pipeline():</span>
<span class="sd">                op1 = (dsl.ContainerOp(name=&#39;example&#39;, image=&#39;nginx:alpine&#39;)</span>
<span class="sd">                          .container</span>
<span class="sd">                            .add_env_variable(V1EnvVar(name=&#39;HOST&#39;, value=&#39;foo.bar&#39;))</span>
<span class="sd">                            .add_env_variable(V1EnvVar(name=&#39;PORT&#39;, value=&#39;80&#39;))</span>
<span class="sd">                            .parent # return the parent `ContainerOp`</span>
<span class="sd">                        )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_container</span>

    <span class="k">def</span> <span class="nf">_set_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metadata</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;_set_metadata passes the containerop the metadata information</span>
<span class="sd">        and configures the right output</span>
<span class="sd">        Args:</span>
<span class="sd">          metadata (ComponentSpec): component metadata</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">ComponentSpec</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;_set_metadata is expecting ComponentSpec.&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="n">metadata</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_outputs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">output_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">param_type</span>
                <span class="k">for</span> <span class="n">output_meta</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metadata</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">output_meta</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">output</span><span class="p">:</span>
                        <span class="n">output_type</span> <span class="o">=</span> <span class="n">output_meta</span><span class="o">.</span><span class="n">type</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">param_type</span> <span class="o">=</span> <span class="n">output_type</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>

<div class="viewcode-block" id="ContainerOp.add_pvolumes"><a class="viewcode-back" href="../../../source/kfp.dsl.html#kfp.dsl.ContainerOp.add_pvolumes">[docs]</a>    <span class="k">def</span> <span class="nf">add_pvolumes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                     <span class="n">pvolumes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">V1Volume</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates the existing pvolumes dict, extends volumes and volume_mounts</span>
<span class="sd">        and redefines the pvolume attribute.</span>

<span class="sd">        Args:</span>
<span class="sd">            pvolumes: Dictionary. Keys are mount paths, values are Kubernetes</span>
<span class="sd">                      volumes or inherited types (e.g. PipelineVolumes).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">pvolumes</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">mount_path</span><span class="p">,</span> <span class="n">pvolume</span> <span class="ow">in</span> <span class="n">pvolumes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">pvolume</span><span class="p">,</span> <span class="s2">&quot;dependent_names&quot;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dependent_names</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">pvolume</span><span class="o">.</span><span class="n">dependent_names</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">pvolume</span> <span class="o">=</span> <span class="n">PipelineVolume</span><span class="p">(</span><span class="n">volume</span><span class="o">=</span><span class="n">pvolume</span><span class="p">)</span>
                <span class="n">pvolume</span> <span class="o">=</span> <span class="n">pvolume</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pvolumes</span><span class="p">[</span><span class="n">mount_path</span><span class="p">]</span> <span class="o">=</span> <span class="n">pvolume</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_volume</span><span class="p">(</span><span class="n">pvolume</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_container</span><span class="o">.</span><span class="n">add_volume_mount</span><span class="p">(</span><span class="n">V1VolumeMount</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">pvolume</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">mount_path</span><span class="o">=</span><span class="n">mount_path</span>
                <span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pvolume</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pvolumes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pvolume</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pvolumes</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span></div></div>


<span class="c1"># proxy old ContainerOp properties to ContainerOp.container</span>
<span class="c1"># with PendingDeprecationWarning.</span>
<span class="n">ContainerOp</span> <span class="o">=</span> <span class="n">_proxy_container_op_props</span><span class="p">(</span><span class="n">ContainerOp</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_MultipleOutputsError</span><span class="p">:</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">raise_error</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;This task has multiple outputs. Use `task.outputs[&lt;output name&gt;]` dictionary to refer to the one you need.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">_MultipleOutputsError</span><span class="o">.</span><span class="n">raise_error</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">_MultipleOutputsError</span><span class="o">.</span><span class="n">raise_error</span><span class="p">()</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Google

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>